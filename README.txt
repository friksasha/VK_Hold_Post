VK_Hold_Post_2 v0.6

Переосмысление первой версии с новыми фичами и костылями.

Назначение:
Создавать отложенные посты с переданными материалами в скрипт в группе в которой есть права редактора.
На данный момент может работать с ссылками на материал из ВК и одним указанным хештегом и создавать посты только с одним материалом

Поддерживается:
1 передаваемый тег для поста
1 материал для поста
Поддержка специальных тегов которые надо постить только в определённое время
Создание постов на указанное время
Пишется лог важных действий
Стандартный тег для всех постов
Исключённые теги передаваемые для поста которым не надо ставить стандартный тег
Обработка случаев если время занято
Обработка случаев если нет поста со специальным тегом
Поддерживается копирования перевода картинки из её описания в текст поста. Для этого материал должен быть передан с тегом содержащим в себе "translate" или "перевод"
Перевод пишется перед тегами. Теги пишутся после перевода.

Метод работы:
Инициализируется
	Проверяет корректность конфига
	Выясняет дату и время с которого начать создавать посты
Получает токен
Проверяет наличие прав на группу путём попытки получения отложенных постов
Получает материалы для постинга
Получает список отложенных постов
Подготавливает посты
После подготовки постит их

Запуск:
Поставить Python 3
Запустить main.py 
Или открыть консоль cmd перейти в папку со скриптом и запустить main.py и если требуется указать аргументы
Или создать bat файл в папке со скриптом запускающий main.py и если требуется аргументы

Аргументы которые можно передать:
-h, --help - справка
-sd START_DATE, --start_date START_DATE		Дата начала постинга. Формат 01.01.2020 или today если с "сегодня".
-st START_TIME, --start_time START_TIME		Время начала постинга. Формат 10-00. Время должно быть в списке времени [Time] или [STagTime] в конфиге
-vr VIRTUAL, --virtual VIRTUAL			Подготовить посты и выйти без постинга. Для проверки наличия материалов на все задействованые даты время и ошибок. Значения 0 или 1.

Если время и дата не указаны, начало начинается со следующего дня с самого раннего времени из конфига.
Если указана только дата, то начнётся с указанной даты с самого раннего времени из конфига.
Если указать сегодняшнюю дату или today, то постинг начнётся с ближайшего будущего времени до которого больше 5 минут.
Если указано только время, то если оно будет сегодня, то с сегодня с этого времени, если оно уже прошло сегодня, то на следующий день с этого времени.
Если указаны дата и время, то начало будет с указанных даты и времени.


Настройка Config.ini:
Скрипт не умеет восстанавливать конфиг, так что в папке лежит его копия.

Блок [Main] - основные параметры скрипта

source_type - тип материалов ссылок на материалы для постов. 
link - ссылки на материал из ВК
На данный момент поддерживается только способ link
Ссылка должна содержать "photo", "video", "album" или "doc"
Формат ввода
Все хештеги должны начинаться с #
<Ссылка><2 пробела><Основной хештег><пробел><<дополнительный тег 1><пробел><дополнительный тег 2><пробел><...>>
Время куда надо поставить пост определяется по основному хештегу.
Если основной хештег или один из дополнительных находится в списке исключённых, то стандартный тег ставиться не будет.
Если ни один хештег не в исключённых, то перед основным хештегом будет идти стандартный тег.
Примеры
https://vk.com/club1?z=photo-1_457242032%2Falbum-1_00%2Frev	#tag
https://vk.com/club1?z=photo-1_457242032%2Falbum-1_00%2Frev	#tag #tag2 #tag3 #tag4
https://vk.com/club1?z=photo-1_457241993

source_input - способ ввода материалов в скрипт
paste - вставка ссылок в скрипт когда он попросит это сделать и набрать end для окончания
На данный момент поддерживается только способ paste 

permission_score - права которые будут даны скрипту. Посмотреть их можно на https://vk.com/dev/permissions
Указываются путём указания необходимых прав через "+"
Пример
1+4+1024+8196
Означает что будут запрошены права
Пользователь разрешил отправлять ему уведомления
Доступ к фотографиям. 
Доступ к статусу пользователя. 
Доступ к обычным и расширенным методам работы со стеной. 

appid - id приложения от имени которого будет выполняться скрипт

groupid - id группы в которой будут создаваться посты. В ней надо быть редактором. Значение может быть как положительным, так и отрицательным. Это не влияет

save_token - Требуется ли сохранить токен после его получения.
0 - не требуется. Если он был сохранён ранее, то будет удалён из Token.ini.
1 - требуется. После получения токена он будет сохранён в Token.ini.
Токен пишется в Token.ini т.к. запись в основной конфиг затирает коммантарии

conflict_time_act - что делать если будет время на котором уже существует пост.
nexttime - перейти к следующему времени. Материал бует опубликован на следующем времени подходящем для материала
stop - прекратить выполнение и выдать ошибку. Лог в файл не записывается.

absence_spost_act - что делать если нет поста со специальным тегом на какое-то время
usualpost - подставить первый попавшийся обычный пост на это время
skip - пропустить. Ничего не делать
stop - остановиться и выдать ошибку. Лог в файл не записывается.

time_type - тип времени для обычных постов
fixed - фиксированный. Указание конкретных времён когда надо сделать обычный пост
Должен ещё быть every - через какой-то промежуток, но это не реализовано

log_level - Уровень логов которые будут писаться в файл. Не влияет на логи на экране.
0 - Писать всё
1 - Важное info
2 - только warning (почти ничем не отличется от 1)
Отключить запись нельзя.



Блок [Post] - основные параметры постов

default_tag - Cтандартный тег который будет добавляться всем постам, кроме тех тег которых не в исключении

autor_marker - Наличие маркера(имени) автора в посте
1 - указывать имя автора поста 
0 - не указывать имя автора поста

mute_notifications - Блокировка оповещений об посте.
0 -  не блокировать
1 - блокировать



[Time] - Набор времени когда надо делать посты. Формат %H-%M
Нумерация параметров начинается с 1
Можно убирать и добавлять времена, главное чтобы цифра посте time шла по порядку.
Времена можно добавлять в любом порядке. Они потом сортируются по возрастанию внутри скрипта
time1 = 00-00
time2 = 03-00
time3 = 06-00
time4 = 09-00
time5 = 18-00
time6 = 21-00
Означает что все посты без тегов или не со специальными тегами будут постится на эти времена



[ExcepTag] - Блок исключённых тегов которым не надо ставить стандартный тег
Нумерация параметров начинается с 1
Тег указывается без #
etag1 = tag2 - посты с тегом tag2 не будут иметь default_tag 



[STag] - Блок перечисления специальных тегов. Здесь же задаётся их приоритет если будет несколько тегов на одно время
Нумерация параметров начинается с 1
Тег указывается без #
stag1 = tag10
stag2 = tag11
stag3 = tag12
Допустим для tag11 и tag12 будет указано одно время, то сначала будут опубликованы материалы помеченные tag11, а когда их не останется тогда материалы помеченные tag12



[STagTime] - Блок указания времени когда должены публиковаться спецтеги
Указывается тез из блока перед без # дальше время в формате формате %H-%M
tag10 = 12-00
tag11 = 15-00
tag12 = 15-00